# 智能合同管理系统 MVP 需求文档

## 1. 文档概述

### 1.1 文档目的

本文档明确智能合同管理系统 MVP（最小可行产品）的核心需求、技术架构、功能模块、交互流程及验收标准，为开发团队提供统一的执行依据，确保在 7-10 天内交付可用的 Web 应用原型。

### 1.2 核心目标

以 “AI 合同解析” 为核心亮点，实现合同上传、文本提取、AI 智能分析（关键条款、风险点、关键日期）、结果展示及日历导出功能，满足用户快速识别合同核心信息与风险的核心需求。

### 1.3 适用范围

开发团队（前端、后端、测试）、产品负责人及相关 stakeholders。

## 2. 技术栈规范

### 2.1 前端技术栈



| 技术项      | 选型                       | 备注                    |
| -------- | ------------------------ | --------------------- |
| 框架       | Vue 3 + `<script setup>` | 高效开发，减少冗余代码           |
| 构建工具     | Vite                     | 极速冷启动与热更新             |
| UI 组件库   | Element Plus             | 兼容 Vue 3，提供上传、列表等现成组件 |
| 路由       | Vue Router               | 实现页面跳转与路由守卫           |
| 状态管理     | Pinia                    | 轻量直观，适配 MVP 场景        |
| HTTP 客户端 | Axios                    | 处理前后端数据交互             |
| 其他依赖     | ics.js                   | 生成日历导出文件（.ics）        |

### 2.2 后端技术栈



| 技术项     | 选型                                   | 备注                          |
| ------- | ------------------------------------ | --------------------------- |
| 框架      | Express.js                           | 轻量灵活，生态成熟                   |
| 身份认证    | JWT + bcrypt                         | 实现用户登录校验与密码加密               |
| 数据库 ORM | Prisma                               | 类型安全，适配 Supabase PostgreSQL |
| 文件处理    | multer + pdf-parse + mammoth         | 处理文件上传与 PDF/Word 文本提取       |
| AI 集成   | OpenAI GPT-4 API / Google Gemini API | 实现合同文本智能解析                  |
| 部署平台    | Railway/Render                       | 后端服务部署                      |

### 2.3 数据层



| 技术项  | 选型                  | 备注                |
| ---- | ------------------- | ----------------- |
| 数据库  | Supabase PostgreSQL | 提供云端数据库服务与管理后台    |
| 存储方案 | 本地存储（MVP 阶段）        | 合同文件存储在后端服务器，记录路径 |

## 3. 数据库设计

### 3.1 表结构定义

#### 3.1.1 users（用户表）



| 字段名            | 类型     | 约束               | 说明            |
| -------------- | ------ | ---------------- | ------------- |
| id             | UUID   | Primary Key      | 用户唯一标识        |
| email          | String | Unique, Not Null | 用户登录邮箱        |
| password\_hash | String | Not Null         | bcrypt 加密后的密码 |

#### 3.1.2 contracts（合同表）



| 字段名          | 类型        | 约束                               | 说明                         |
| ------------ | --------- | -------------------------------- | -------------------------- |
| id           | UUID      | Primary Key                      | 合同唯一标识                     |
| user\_id     | UUID      | Foreign Key (users.id), Not Null | 关联所属用户                     |
| file\_name   | String    | Not Null                         | 合同原始文件名                    |
| file\_url    | String    | Not Null                         | 合同在服务器的存储路径                |
| uploaded\_at | Timestamp | Not Null                         | 上传时间（默认当前时间）               |
| title        | String    | Not Null                         | 合同标题（默认等于 file\_name，支持编辑） |

#### 3.1.3 contract\_analyses（合同分析结果表）



| 字段名          | 类型        | 约束                                           | 说明               |
| ------------ | --------- | -------------------------------------------- | ---------------- |
| id           | UUID      | Primary Key                                  | 分析结果唯一标识         |
| contract\_id | UUID      | Foreign Key (contracts.id), Unique, Not Null | 关联所属合同（一对一）      |
| key\_terms   | JSONB     | Not Null                                     | 关键条款（如金额、甲方乙方等）  |
| risk\_points | JSONB     | Not Null                                     | 风险点（如自动续费、违约责任等） |
| key\_dates   | JSONB     | Not Null                                     | 关键日期（如签订日、到期日等）  |
| analyzed\_at | Timestamp | Not Null                                     | 分析完成时间（默认当前时间）   |

### 3.2 数据关系



* 1 个用户（users）可关联多个合同（contracts）：一对多关系

* 1 个合同（contracts）对应 1 个分析结果（contract\_analyses）：一对一关系

## 4. 功能需求

### 4.1 用户模块

#### 4.1.1 注册功能



* 输入项：邮箱（需验证格式）、密码（≥8 位，支持字母 + 数字组合）、确认密码

* 校验规则：邮箱未被注册、两次密码一致

* 交互反馈：注册成功后自动跳转至登录页，失败提示具体原因（如 “邮箱已注册”）

#### 4.1.2 登录功能



* 输入项：邮箱、密码

* 校验规则：邮箱存在、密码与加密存储的密码匹配

* 交互反馈：登录成功后跳转至仪表盘页，失败提示 “邮箱或密码错误”

* 状态保持：登录后生成 JWT 令牌，存储在本地存储（localStorage），有效期 7 天

### 4.2 合同管理模块

#### 4.2.1 合同上传



* 支持文件类型：PDF、Word（.docx）

* 上传限制：单个文件大小≤20MB

* 交互流程：

1. 点击 “上传合同” 按钮，弹出文件选择框

2. 选择文件后显示上传进度条

3. 上传成功后，合同列表实时刷新，显示新上传的合同（标题默认文件名）

* 异常处理：文件类型不支持、文件过大时给出明确提示

#### 4.2.2 合同列表（仪表盘）



* 展示字段：合同标题、上传时间、文件类型（图标标识）

* 操作功能：

1. 点击合同标题跳转至详情页

2. 支持标题编辑（点击编辑图标，输入新标题后保存）

3. 支持删除合同（需二次确认，删除后关联的分析结果同步删除）

* 布局：响应式网格布局，适配桌面端（每行 3-4 个）、平板端（每行 2 个）

### 4.3 AI 合同解析模块

#### 4.3.1 文本提取



* 自动提取：合同上传成功后，后端自动调用 pdf-parse/mammoth 工具提取文本

* 提取范围：PDF/Word 文件中的全部可识别文本（忽略图片中的文字，MVP 阶段暂不支持 OCR）

#### 4.3.2 AI 智能分析



* 分析触发：文本提取完成后自动调用 AI API，无需用户手动操作

* 分析结果：

1. 关键条款：结构化提取合同核心信息，如合同金额、甲方 / 乙方名称、服务内容等，格式为`[{"term": "字段名", "value": "字段值"}]`

2. 风险点：识别潜在风险条款，如自动续费、高额违约金、单方解约限制等，格式为`[{"risk": "风险类型", "description": "风险描述"}]`

3. 关键日期：提取重要时间节点，如合同签订日、生效日、到期日、付款日等，格式为`[{"date_type": "日期类型", "date_value": "YYYY-MM-DD"}]`

* 性能要求：单份合同（≤50 页）分析时间≤30 秒

#### 4.3.3 结果展示（合同详情页）



* 页面布局：顶部操作区 + 左右分栏

1. 顶部操作区：合同标题（可编辑）、下载原文件按钮、返回列表按钮

2. 左栏：合同文本预览（支持滚动，显示提取后的纯文本）、下载文本按钮

3. 右栏：结构化分析结果（分三个卡片）

* 关键信息卡片：表格形式展示 key\_terms，支持复制字段值

* 风险提示卡片：红色 / 黄色警示图标，列表展示 risk\_points，风险等级标注（高 / 中）

* 关键日期卡片：突出显示到期日，配 “添加到日历” 按钮

- 交互反馈：分析过程中显示 “AI 分析中，请稍候...” 加载动画；分析失败显示 “解析失败，请重试” 按钮

### 4.4 日历导出功能



* 触发方式：点击关键日期卡片中的 “添加到日历” 按钮

* 导出内容：ICS 文件，包含合同标题（事件名称）、关键日期（事件时间）、合同 ID（备注）

* 兼容要求：支持导入 Google 日历、Outlook、苹果日历

* 交互反馈：文件自动下载，提示 “日历文件已生成，请导入使用”

## 5. 非功能需求

### 5.1 性能要求



* 页面加载时间：首屏（登录页）≤2 秒，其他页面≤1.5 秒

* 接口响应时间：用户注册 / 登录≤500ms，文件上传≤10 秒（20MB 文件），AI 分析结果查询≤1 秒

* 并发支持：MVP 阶段支持≤50 个同时在线用户

### 5.2 兼容性要求



* 浏览器兼容：Chrome（≥90 版本）、Firefox（≥88 版本）、Edge（≥90 版本）

* 设备兼容：桌面端（分辨率≥1366×768）、平板端（≥768×1024）

### 5.3 安全性要求



* 密码安全：使用 bcrypt 加密存储，不明文传输

* 接口安全：所有需登录接口添加 JWT 令牌校验，非法请求返回 401 状态码

* 文件安全：合同文件按用户 ID 分目录存储，防止越权访问

* 数据安全：用户数据与合同数据隔离，分析结果仅所属用户可见

### 5.4 可用性要求



* 错误处理：所有操作失败均给出明确提示（如网络错误、文件格式错误），提供重试路径

* 操作指引：关键功能（如上传、导出）配简单图标或文字提示

* 异常恢复：AI 分析失败后支持手动重试（点击重试按钮重新触发分析）

## 6. 验收标准

### 6.1 功能验收



| 功能点   | 验收标准                                                               |
| ----- | ------------------------------------------------------------------ |
| 用户注册  | 1. 邮箱格式错误提示正确；2. 重复邮箱注册提示正确；3. 注册成功后跳转登录页                          |
| 用户登录  | 1. 邮箱 / 密码错误提示正确；2. 登录成功跳转仪表盘；3. 本地存储存在 JWT 令牌                     |
| 合同上传  | 1. 支持 PDF/docx 上传；2. 20MB 以上文件提示限制；3. 上传后列表实时刷新                    |
| AI 解析 | 1. 提取文本完整（无明显缺失）；2. 关键条款提取准确率≥80%；3. 风险点识别准确率≥75%；4. 关键日期提取准确率≥90% |
| 结果展示  | 1. 布局清晰，无样式错乱；2. 卡片分类明确；3. 复制 / 下载功能正常                             |
| 日历导出  | 1. 点击按钮生成 ICS 文件；2. 文件可成功导入主流日历工具；3. 事件信息完整                        |

### 6.2 非功能验收



| 需求类型 | 验收标准                                                 |
| ---- | ---------------------------------------------------- |
| 性能   | 1. 首屏加载≤2 秒；2. 接口响应≤500ms（除上传 / 分析）；3. 50 页合同分析≤30 秒 |
| 兼容性  | 1. 支持指定浏览器版本；2. 桌面 / 平板端显示正常，无功能失效                   |
| 安全性  | 1. 密码加密存储；2. 未登录状态无法访问合同列表 / 详情；3. 无法访问他人合同          |

## 7. 项目交付物



1. 前端代码（Vue 3）及部署包（部署至 Vercel）

2. 后端代码（Node.js/Express）及部署包（部署至 Railway/Render）

3. 数据库脚本（Prisma 迁移文件）及 Supabase 数据库实例

4. 系统测试报告（含功能测试、兼容性测试、性能测试结果）

5. 简单用户操作手册（含核心功能使用步骤）

> （注：文档部分内容可能由 AI 生成）